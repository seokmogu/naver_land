<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>네이버 부동산 수집기 - 실시간 모니터링</title>
    
    <!-- Modern CSS Framework & Icons -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- React & Babel for modern component structure -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Custom CSS Variables for Design System */
        :root {
            --primary-blue: #3b82f6;
            --primary-blue-dark: #1e40af;
            --success-green: #10b981;
            --warning-yellow: #f59e0b;
            --error-red: #ef4444;
            --neutral-gray: #6b7280;
            --background-light: #f8fafc;
            --card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --animation-duration: 0.3s;
        }

        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            :root {
                --background-light: #1f2937;
            }
        }

        /* Smooth animations */
        .animate-fade-in {
            animation: fadeIn var(--animation-duration) ease-in-out;
        }

        .animate-slide-in {
            animation: slideIn var(--animation-duration) ease-out;
        }

        .animate-pulse-custom {
            animation: pulseCustom 2s infinite;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }

        @keyframes pulseCustom {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }

        /* Custom progress bar */
        .progress-ring {
            transform: rotate(-90deg);
        }

        .progress-ring-circle {
            transition: stroke-dasharray 0.5s ease-in-out;
        }

        /* Connection status indicator */
        .connection-indicator {
            position: relative;
        }

        .connection-indicator::before {
            content: '';
            position: absolute;
            top: -2px;
            right: -2px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--success-green);
            animation: pulseCustom 2s infinite;
        }

        .connection-indicator.disconnected::before {
            background: var(--error-red);
        }

        /* Mobile-first responsive utilities */
        .mobile-card {
            @apply p-4 bg-white rounded-lg shadow-md mb-4;
        }

        @media (min-width: 768px) {
            .mobile-card {
                @apply p-6 mb-6;
            }
        }

        /* Accessibility improvements */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus indicators for keyboard navigation */
        .focus-ring:focus {
            outline: 2px solid var(--primary-blue);
            outline-offset: 2px;
        }

        /* Skeleton loading */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Custom scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: var(--neutral-gray);
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: var(--primary-blue);
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <div id="dashboard-root"></div>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo } = React;

        // Constants
        const GANGNAM_DONGS = [
            "개포동", "논현동", "대치동", "도곡동", "삼성동", "세곡동", "수서동", 
            "신사동", "압구정동", "역삼동", "일원동", "자곡동", "청담동", "행정동"
        ];

        const API_ENDPOINTS = {
            status: '/api/status',
            logs: '/api/logs', 
            results: '/api/results'
        };

        const REFRESH_INTERVAL = 5000; // 5초마다 업데이트
        const HEARTBEAT_INTERVAL = 10000; // 10초마다 하트비트

        // Utility functions
        const formatNumber = (num) => {
            return new Intl.NumberFormat('ko-KR').format(num);
        };

        const formatTime = (timestamp) => {
            return new Date(timestamp).toLocaleString('ko-KR', {
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
        };

        const calculateETA = (completed, total, speed) => {
            if (speed <= 0 || completed >= total) return "완료됨";
            
            const remaining = total - completed;
            const minutesLeft = Math.round(remaining / speed);
            
            if (minutesLeft < 60) {
                return `${minutesLeft}분 후`;
            } else {
                const hours = Math.floor(minutesLeft / 60);
                const mins = minutesLeft % 60;
                return `${hours}시간 ${mins}분 후`;
            }
        };

        // Components
        const ConnectionStatus = ({ isConnected, lastUpdate }) => (
            <div className={`connection-indicator flex items-center space-x-2 ${isConnected ? '' : 'disconnected'}`}>
                <div className={`w-3 h-3 rounded-full ${isConnected ? 'bg-green-500' : 'bg-red-500'} animate-pulse-custom`}></div>
                <span className="text-sm text-gray-600">
                    {isConnected ? '실시간 연결됨' : '연결 끊김'} 
                    {lastUpdate && (
                        <span className="ml-1 text-xs">
                            ({formatTime(lastUpdate)})
                        </span>
                    )}
                </span>
            </div>
        );

        const ProgressRing = ({ percentage, size = 120, strokeWidth = 8 }) => {
            const radius = (size - strokeWidth) / 2;
            const circumference = radius * 2 * Math.PI;
            const strokeDasharray = `${percentage * circumference / 100} ${circumference}`;

            return (
                <div className="flex items-center justify-center">
                    <svg width={size} height={size} className="progress-ring">
                        <circle
                            cx={size / 2}
                            cy={size / 2}
                            r={radius}
                            stroke="#e5e7eb"
                            strokeWidth={strokeWidth}
                            fill="none"
                        />
                        <circle
                            cx={size / 2}
                            cy={size / 2}
                            r={radius}
                            stroke="url(#gradient)"
                            strokeWidth={strokeWidth}
                            fill="none"
                            strokeLinecap="round"
                            strokeDasharray={strokeDasharray}
                            className="progress-ring-circle"
                        />
                        <defs>
                            <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                <stop offset="0%" stopColor="#3b82f6" />
                                <stop offset="100%" stopColor="#1e40af" />
                            </linearGradient>
                        </defs>
                    </svg>
                    <div className="absolute text-center">
                        <div className="text-3xl font-bold text-blue-600">{percentage}%</div>
                        <div className="text-sm text-gray-500">완료</div>
                    </div>
                </div>
            );
        };

        const StatCard = ({ icon, title, value, change, color = "blue", loading = false }) => (
            <div className="mobile-card animate-fade-in">
                {loading ? (
                    <div className="animate-pulse">
                        <div className="skeleton h-4 w-20 mb-2 rounded"></div>
                        <div className="skeleton h-8 w-16 rounded"></div>
                    </div>
                ) : (
                    <div className="flex items-center">
                        <div className={`p-3 rounded-full bg-${color}-100 text-${color}-600 mr-4`}>
                            <i className={`fas ${icon} text-xl`} aria-hidden="true"></i>
                        </div>
                        <div className="flex-1">
                            <p className="text-sm font-medium text-gray-600">{title}</p>
                            <div className="flex items-baseline">
                                <p className="text-2xl font-semibold text-gray-900">{formatNumber(value)}</p>
                                {change !== undefined && (
                                    <p className={`ml-2 text-sm ${change >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                        {change >= 0 ? '+' : ''}{change}%
                                    </p>
                                )}
                            </div>
                        </div>
                    </div>
                )}
            </div>
        );

        const DongCard = ({ dong, status, count, onClick }) => {
            const getStatusColor = () => {
                switch (status) {
                    case 'completed': return 'bg-green-100 border-green-200 text-green-800';
                    case 'in_progress': return 'bg-yellow-100 border-yellow-200 text-yellow-800 animate-pulse-custom';
                    case 'pending': return 'bg-gray-100 border-gray-200 text-gray-600';
                    default: return 'bg-gray-100 border-gray-200 text-gray-600';
                }
            };

            const getStatusIcon = () => {
                switch (status) {
                    case 'completed': return 'fa-check-circle';
                    case 'in_progress': return 'fa-spinner fa-spin';
                    case 'pending': return 'fa-clock';
                    default: return 'fa-question-circle';
                }
            };

            const getStatusText = () => {
                switch (status) {
                    case 'completed': return '완료';
                    case 'in_progress': return '진행중';
                    case 'pending': return '대기';
                    default: return '알 수 없음';
                }
            };

            return (
                <button
                    className={`w-full p-3 border-2 rounded-lg transition-all duration-300 hover:shadow-md focus-ring ${getStatusColor()}`}
                    onClick={() => onClick(dong)}
                    aria-label={`${dong} - ${getStatusText()}, ${count}개 매물`}
                >
                    <div className="flex flex-col items-center space-y-2">
                        <i className={`fas ${getStatusIcon()} text-lg`} aria-hidden="true"></i>
                        <div className="font-medium text-sm">{dong}</div>
                        <div className="text-xs">{getStatusText()}</div>
                        {count > 0 && (
                            <div className="text-xs font-bold">{formatNumber(count)}개</div>
                        )}
                    </div>
                </button>
            );
        };

        const LogEntry = ({ log, index }) => {
            const getLogIcon = () => {
                switch (log.type) {
                    case 'start': return { icon: 'fa-rocket', color: 'text-blue-500' };
                    case 'complete': return { icon: 'fa-check-circle', color: 'text-green-500' };
                    case 'heartbeat': return { icon: 'fa-heartbeat', color: 'text-yellow-500' };
                    case 'error': return { icon: 'fa-exclamation-triangle', color: 'text-red-500' };
                    default: return { icon: 'fa-info-circle', color: 'text-gray-500' };
                }
            };

            const { icon, color } = getLogIcon();

            return (
                <div 
                    className="flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg transition-colors duration-200 animate-slide-in"
                    style={{ animationDelay: `${index * 0.1}s` }}
                >
                    <i className={`fas ${icon} ${color} mt-1 flex-shrink-0`} aria-hidden="true"></i>
                    <div className="flex-1 min-w-0">
                        <div className="text-sm text-gray-900">{log.message}</div>
                        <div className="text-xs text-gray-500 mt-1">{formatTime(log.timestamp)}</div>
                    </div>
                </div>
            );
        };

        const FilterBar = ({ activeFilter, onFilterChange, searchTerm, onSearchChange }) => (
            <div className="mobile-card">
                <div className="flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0">
                    <div className="flex flex-wrap gap-2">
                        {['전체', '완료', '진행중', '대기'].map((filter) => (
                            <button
                                key={filter}
                                className={`px-4 py-2 rounded-full text-sm font-medium transition-colors duration-200 focus-ring ${
                                    activeFilter === filter 
                                        ? 'bg-blue-600 text-white' 
                                        : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                }`}
                                onClick={() => onFilterChange(filter)}
                                aria-pressed={activeFilter === filter}
                            >
                                {filter}
                            </button>
                        ))}
                    </div>
                    <div className="relative">
                        <i className="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" aria-hidden="true"></i>
                        <input
                            type="text"
                            placeholder="동 이름으로 검색..."
                            className="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus-ring focus:border-blue-500 w-full md:w-64"
                            value={searchTerm}
                            onChange={(e) => onSearchChange(e.target.value)}
                            aria-label="동 이름으로 검색"
                        />
                    </div>
                </div>
            </div>
        );

        const SystemStatus = ({ systemInfo, onRefresh, isRefreshing }) => (
            <div className="mobile-card">
                <div className="flex items-center justify-between mb-4">
                    <h3 className="text-lg font-semibold text-gray-900 flex items-center">
                        <i className="fas fa-server mr-2 text-blue-600" aria-hidden="true"></i>
                        시스템 상태
                    </h3>
                    <button
                        className={`px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 focus-ring ${isRefreshing ? 'animate-spin' : ''}`}
                        onClick={onRefresh}
                        disabled={isRefreshing}
                        aria-label="새로고침"
                    >
                        <i className="fas fa-sync-alt" aria-hidden="true"></i>
                    </button>
                </div>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div className="text-center p-3 bg-gray-50 rounded-lg">
                        <div className="text-sm text-gray-600">메모리</div>
                        <div className="text-lg font-semibold">{systemInfo.memory || 'N/A'}</div>
                    </div>
                    <div className="text-center p-3 bg-gray-50 rounded-lg">
                        <div className="text-sm text-gray-600">CPU</div>
                        <div className="text-lg font-semibold">{systemInfo.cpu || 'N/A'}</div>
                    </div>
                    <div className="text-center p-3 bg-gray-50 rounded-lg">
                        <div className="text-sm text-gray-600">디스크</div>
                        <div className="text-lg font-semibold">{systemInfo.disk || 'N/A'}</div>
                    </div>
                    <div className="text-center p-3 bg-gray-50 rounded-lg">
                        <div className="text-sm text-gray-600">업타임</div>
                        <div className="text-lg font-semibold">{systemInfo.uptime || 'N/A'}</div>
                    </div>
                </div>
            </div>
        );

        // Main Dashboard Component
        const Dashboard = () => {
            const [data, setData] = useState({
                status: null,
                logs: null,
                results: null
            });
            const [loading, setLoading] = useState(true);
            const [isConnected, setIsConnected] = useState(true);
            const [lastUpdate, setLastUpdate] = useState(null);
            const [activeFilter, setActiveFilter] = useState('전체');
            const [searchTerm, setSearchTerm] = useState('');
            const [selectedDong, setSelectedDong] = useState(null);
            const [isRefreshing, setIsRefreshing] = useState(false);

            // API 호출 함수
            const fetchData = useCallback(async () => {
                try {
                    const [statusRes, logsRes, resultsRes] = await Promise.all([
                        fetch(API_ENDPOINTS.status),
                        fetch(API_ENDPOINTS.logs),
                        fetch(API_ENDPOINTS.results)
                    ]);

                    const statusData = await statusRes.json();
                    const logsData = await logsRes.json();
                    const resultsData = await resultsRes.json();

                    setData({
                        status: statusData,
                        logs: logsData,
                        results: resultsData
                    });
                    setIsConnected(true);
                    setLastUpdate(Date.now());
                    setLoading(false);
                } catch (error) {
                    console.error('데이터 로드 실패:', error);
                    setIsConnected(false);
                }
            }, []);

            // 수동 새로고침
            const handleRefresh = useCallback(async () => {
                setIsRefreshing(true);
                await fetchData();
                setTimeout(() => setIsRefreshing(false), 500);
            }, [fetchData]);

            // 자동 새로고침 설정
            useEffect(() => {
                fetchData();
                const interval = setInterval(fetchData, REFRESH_INTERVAL);
                return () => clearInterval(interval);
            }, [fetchData]);

            // 하트비트 설정
            useEffect(() => {
                const heartbeat = setInterval(() => {
                    if (navigator.onLine) {
                        fetchData();
                    }
                }, HEARTBEAT_INTERVAL);
                return () => clearInterval(heartbeat);
            }, [fetchData]);

            // 동 필터링 및 검색
            const filteredDongs = useMemo(() => {
                if (!data.status) return [];

                const completedDongs = (data.status.completed_tasks || []).map(task => task.dong_name);
                const activeDongs = (data.status.active_tasks || []).map(task => task.dong_name);

                return GANGNAM_DONGS
                    .filter(dong => {
                        // 검색 필터
                        if (searchTerm && !dong.includes(searchTerm)) return false;

                        // 상태 필터
                        if (activeFilter === '전체') return true;
                        if (activeFilter === '완료') return completedDongs.includes(dong);
                        if (activeFilter === '진행중') return activeDongs.includes(dong);
                        if (activeFilter === '대기') return !completedDongs.includes(dong) && !activeDongs.includes(dong);

                        return true;
                    })
                    .map(dong => {
                        let status = 'pending';
                        let count = 0;

                        if (completedDongs.includes(dong)) {
                            status = 'completed';
                            const task = data.status.completed_tasks.find(t => t.dong_name === dong);
                            count = task?.total_collected || 0;
                        } else if (activeDongs.includes(dong)) {
                            status = 'in_progress';
                            const task = data.status.active_tasks.find(t => t.dong_name === dong);
                            count = task?.total_collected || 0;
                        }

                        return { dong, status, count };
                    });
            }, [data.status, activeFilter, searchTerm]);

            // 통계 계산
            const stats = useMemo(() => {
                if (!data.status) return {};

                const completed = data.status.completed || 0;
                const inProgress = data.status.in_progress || 0; 
                const totalProperties = data.status.total_properties || 0;
                const totalDongs = GANGNAM_DONGS.length;
                const progressPercentage = Math.round((completed / totalDongs) * 100);

                return {
                    completed,
                    inProgress,
                    totalProperties,
                    totalDongs,
                    progressPercentage,
                    speed: Math.round(totalProperties / Math.max(1, completed)) || 0
                };
            }, [data.status]);

            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-center">
                            <div className="animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"></div>
                            <p className="mt-4 text-gray-600">대시보드 로딩 중...</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* Header */}
                    <header className="bg-white shadow-sm border-b border-gray-200">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center space-x-3">
                                    <i className="fas fa-tachometer-alt text-2xl text-blue-600" aria-hidden="true"></i>
                                    <div>
                                        <h1 className="text-2xl font-bold text-gray-900">네이버 부동산 수집기</h1>
                                        <p className="text-sm text-gray-600">실시간 모니터링 대시보드</p>
                                    </div>
                                </div>
                                <ConnectionStatus isConnected={isConnected} lastUpdate={lastUpdate} />
                            </div>
                        </div>
                    </header>

                    <main className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                        {/* 전체 진행률 섹션 */}
                        <section className="mb-8">
                            <div className="mobile-card bg-gradient-to-r from-blue-600 to-blue-800 text-white">
                                <div className="flex flex-col lg:flex-row items-center lg:items-start lg:justify-between space-y-6 lg:space-y-0">
                                    <div className="text-center lg:text-left">
                                        <h2 className="text-3xl font-bold mb-2">전체 진행률</h2>
                                        <p className="text-blue-100 mb-4">
                                            강남구 {stats.totalDongs}개 동 중 {stats.completed}개 완료
                                        </p>
                                        <div className="flex flex-col sm:flex-row sm:items-center sm:space-x-6 space-y-2 sm:space-y-0">
                                            <div className="flex items-center space-x-2">
                                                <i className="fas fa-clock" aria-hidden="true"></i>
                                                <span>예상 완료: {calculateETA(stats.completed, stats.totalDongs, 0.5)}</span>
                                            </div>
                                            <div className="flex items-center space-x-2">
                                                <i className="fas fa-bolt" aria-hidden="true"></i>
                                                <span>평균 속도: {stats.speed} 매물/동</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="flex-shrink-0">
                                        <ProgressRing percentage={stats.progressPercentage} size={140} strokeWidth={10} />
                                    </div>
                                </div>
                            </div>
                        </section>

                        {/* 통계 카드 */}
                        <section className="mb-8">
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                                <StatCard 
                                    icon="fa-check-circle" 
                                    title="완료된 동" 
                                    value={stats.completed}
                                    color="green"
                                />
                                <StatCard 
                                    icon="fa-spinner" 
                                    title="진행 중" 
                                    value={stats.inProgress}
                                    color="yellow"
                                />
                                <StatCard 
                                    icon="fa-home" 
                                    title="총 수집 매물" 
                                    value={stats.totalProperties}
                                    color="blue"
                                />
                                <StatCard 
                                    icon="fa-file-alt" 
                                    title="결과 파일" 
                                    value={data.results?.total_files || 0}
                                    color="purple"
                                />
                            </div>
                        </section>

                        {/* 시스템 상태 */}
                        <section className="mb-8">
                            <SystemStatus 
                                systemInfo={{}}
                                onRefresh={handleRefresh}
                                isRefreshing={isRefreshing}
                            />
                        </section>

                        {/* 필터 바 */}
                        <section className="mb-8">
                            <FilterBar 
                                activeFilter={activeFilter}
                                onFilterChange={setActiveFilter}
                                searchTerm={searchTerm}
                                onSearchChange={setSearchTerm}
                            />
                        </section>

                        {/* 동별 상태 그리드 */}
                        <section className="mb-8">
                            <div className="mobile-card">
                                <div className="flex items-center justify-between mb-6">
                                    <h3 className="text-xl font-semibold text-gray-900 flex items-center">
                                        <i className="fas fa-map-marker-alt mr-2 text-blue-600" aria-hidden="true"></i>
                                        동별 상태 ({filteredDongs.length}개)
                                    </h3>
                                    <div className="text-sm text-gray-500">
                                        실시간 업데이트: {formatTime(lastUpdate)}
                                    </div>
                                </div>
                                <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-7 gap-4">
                                    {filteredDongs.map(({ dong, status, count }) => (
                                        <DongCard
                                            key={dong}
                                            dong={dong}
                                            status={status}
                                            count={count}
                                            onClick={setSelectedDong}
                                        />
                                    ))}
                                </div>
                                {filteredDongs.length === 0 && (
                                    <div className="text-center py-12">
                                        <i className="fas fa-search text-4xl text-gray-300 mb-4" aria-hidden="true"></i>
                                        <p className="text-gray-500">조건에 맞는 동이 없습니다.</p>
                                    </div>
                                )}
                            </div>
                        </section>

                        {/* 최근 활동 로그 */}
                        <section className="mb-8">
                            <div className="mobile-card">
                                <div className="flex items-center justify-between mb-6">
                                    <h3 className="text-xl font-semibold text-gray-900 flex items-center">
                                        <i className="fas fa-list-ul mr-2 text-blue-600" aria-hidden="true"></i>
                                        최근 활동
                                    </h3>
                                    <button
                                        className="text-blue-600 hover:text-blue-800 text-sm font-medium focus-ring"
                                        onClick={() => window.open('/api/logs', '_blank')}
                                    >
                                        전체 로그 보기
                                        <i className="fas fa-external-link-alt ml-1" aria-hidden="true"></i>
                                    </button>
                                </div>
                                <div className="space-y-2 max-h-96 overflow-y-auto custom-scrollbar">
                                    {data.logs?.recent_logs?.map((log, index) => (
                                        <LogEntry key={index} log={log} index={index} />
                                    )) || (
                                        <div className="text-center py-8">
                                            <i className="fas fa-inbox text-4xl text-gray-300 mb-4" aria-hidden="true"></i>
                                            <p className="text-gray-500">최근 로그가 없습니다.</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </section>

                        {/* 결과 파일 목록 */}
                        <section>
                            <div className="mobile-card">
                                <div className="flex items-center justify-between mb-6">
                                    <h3 className="text-xl font-semibold text-gray-900 flex items-center">
                                        <i className="fas fa-folder-open mr-2 text-blue-600" aria-hidden="true"></i>
                                        수집 결과 파일
                                    </h3>
                                    <span className="text-sm text-gray-500">
                                        총 {data.results?.total_files || 0}개 파일
                                    </span>
                                </div>
                                <div className="space-y-4">
                                    {data.results?.recent_files?.map((file, index) => (
                                        <div key={index} className="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors duration-200">
                                            <div className="flex items-center space-x-3">
                                                <i className="fas fa-file-alt text-blue-600" aria-hidden="true"></i>
                                                <div>
                                                    <div className="font-medium text-gray-900">{file.filename}</div>
                                                    <div className="text-sm text-gray-500">
                                                        {formatNumber(file.property_count)}개 매물 • {file.size}MB • {file.modified}
                                                    </div>
                                                </div>
                                            </div>
                                            <button
                                                className="text-blue-600 hover:text-blue-800 focus-ring p-2 rounded"
                                                aria-label={`${file.filename} 다운로드`}
                                            >
                                                <i className="fas fa-download" aria-hidden="true"></i>
                                            </button>
                                        </div>
                                    )) || (
                                        <div className="text-center py-8">
                                            <i className="fas fa-folder text-4xl text-gray-300 mb-4" aria-hidden="true"></i>
                                            <p className="text-gray-500">결과 파일이 없습니다.</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </section>
                    </main>

                    {/* Footer */}
                    <footer className="bg-white border-t border-gray-200 py-6 mt-12">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="flex items-center justify-between">
                                <div className="text-sm text-gray-500">
                                    © 2024 네이버 부동산 수집기 모니터링
                                </div>
                                <div className="flex items-center space-x-4">
                                    <button
                                        className="text-gray-400 hover:text-gray-600 focus-ring"
                                        onClick={handleRefresh}
                                        aria-label="새로고침"
                                    >
                                        <i className="fas fa-sync-alt" aria-hidden="true"></i>
                                    </button>
                                    <div className="text-sm text-gray-500">
                                        업데이트 간격: {REFRESH_INTERVAL / 1000}초
                                    </div>
                                </div>
                            </div>
                        </div>
                    </footer>

                    {/* 접근성 개선: 스크린 리더용 라이브 영역 */}
                    <div aria-live="polite" aria-atomic="true" className="sr-only">
                        {stats.completed > 0 && `현재 ${stats.completed}개 동 완료, ${stats.totalProperties}개 매물 수집됨`}
                    </div>
                </div>
            );
        };

        // React App 렌더링
        ReactDOM.render(<Dashboard />, document.getElementById('dashboard-root'));
    </script>
</body>
</html>